const materialsData={"Steel/MS":{density:7.85,color:"#71797E"},"Stainless Steel":{density:8,color:"#CFD4D9"},Aluminum:{density:2.7,color:"#D9DAD9"},"Aluminum 1100":{density:2.71,color:"#D9DAD9"},"Aluminum 2011":{density:2.83,color:"#D9DAD9"},"Aluminum 2014":{density:2.8,color:"#D9DAD9"},"Aluminum 2017":{density:2.8,color:"#D9DAD9"},"Aluminum 2024":{density:2.78,color:"#D9DAD9"},"Aluminum 3003":{density:2.73,color:"#D9DAD9"},"Aluminum 5005":{density:2.7,color:"#D9DAD9"},"Aluminum 5052":{density:2.68,color:"#D9DAD9"},"Aluminum 5056":{density:2.64,color:"#D9DAD9"},"Aluminum 5083":{density:2.66,color:"#D9DAD9"},"Aluminum 5086":{density:2.66,color:"#D9DAD9"},"Aluminum 6061":{density:2.7,color:"#D9DAD9"},"Aluminum 6063":{density:2.7,color:"#D9DAD9"},"Aluminum 7050":{density:2.83,color:"#D9DAD9"},"Aluminum 7075":{density:2.81,color:"#D9DAD9"},"Aluminum 7178":{density:2.83,color:"#D9DAD9"},Brass:{density:8.5,color:"#C49E5B"},Bronze:{density:8.78,color:"#CD7F32"},Copper:{density:8.96,color:"#B87333"},"Cast Iron":{density:7.2,color:"#61666A"},Nickel:{density:8.9,color:"#727472"},"Nickel 200":{density:8.9,color:"#727472"},"Nickel 400":{density:8.8,color:"#727472"},"Nickel R-405":{density:8.83,color:"#727472"},"Nickel K-500":{density:8.44,color:"#727472"},"Nickel 600":{density:8.47,color:"#727472"},"Nickel 625":{density:8.44,color:"#727472"},"Nickel 800H":{density:7.94,color:"#727472"},"Nickel 800AT":{density:7.94,color:"#727472"},"Nickel 825":{density:8.14,color:"#727472"},"Nickel 330":{density:7.94,color:"#727472"},"Nickel 20":{density:8.08,color:"#727472"},"Nickel C-276":{density:8.89,color:"#727472"},"Nickel 2545MD":{density:7.94,color:"#727472"},Magnesium:{density:1.74,color:"#c1c2c3"},Beryllium:{density:1.85,color:"#c0c0c0"},Titanium:{density:4.51,color:"#7A7772"},Zirconium:{density:6.52,color:"#EDF0F1"},Zinc:{density:7.14,color:"#BAC4C8"},Columbium:{density:8.57,color:"#727472"},Molybdenum:{density:10.22,color:"#96919c"},Silver:{density:10.49,color:"#C0C0C0"},Lead:{density:11.34,color:"#212121"},Tantalum:{density:16.69,color:"#A0A0AB"},Tungsten:{density:19.25,color:"#b5ac9f"},Gold:{density:19.32,color:"#FFD700"},Platinum:{density:21.45,color:"#E5E4E2"},Chrome:{density:7.19,color:"#C0C0C0"},Mercury:{density:13.53,color:"#C0C0C0"},Tin:{density:7.31,color:"#C0C0C0"},"PB/Gunmetal":{density:8.78,color:"#2C3539"},Potassium:{density:.86,color:"#E8E8E8"}},shapesData={Round:{params:["Diameter","Length"],formula:"π × (d/2)² × length × density"},Square:{params:["Width","Length"],formula:"width² × length × density"},"Rectangle/Plate/Sheet":{params:["Width","Height","Length"],formula:"width × height × length × density"},Hexagonal:{params:["Diameter","Length"],formula:"3√3/2 × (d/2)² × length × density"},Octagonal:{params:["Diameter","Length"],formula:"2(1+√2) × (d/2)² × length × density"},Pipe:{params:["Outer Diameter","Wall Thickness","Length"],formula:"π × ((OD/2)² - ((OD-2×wall)/2)²) × length × density"},Ring:{params:["Outer Diameter","Inner Diameter","Thickness"],formula:"π × ((OD/2)² - (ID/2)²) × thickness × density"},"Hexagonal (Round)":{params:["Outer Diameter","Wall Thickness","Length"],formula:"3√3/2 × ((OD/2)² - π×((OD-2×wall)/2)²) × length × density"},"Square (Round)":{params:["Width","Inner Diameter","Length"],formula:"(width² - π×(ID/2)²) × length × density"},"Square Pipe":{params:["Width","Wall Thickness","Length"],formula:"(width² - (width-2×wall)²) × length × density"},"Rectangle Pipe":{params:["Width","Height","Wall Thickness","Length"],formula:"(width×height - (width-2×wall)×(height-2×wall)) × length × density"},Triangle:{params:["Width","Height","Length"],formula:"0.5 × width × height × length × density"},Sphere:{params:["Diameter"],formula:"(4/3) × π × (d/2)³ × density"},"Trapezoid/Trapezium":{params:["Width 1","Width 2","Height","Length"],formula:"0.5 × (W1 + W2) × height × length × density"},Oval:{params:["Width","Height","Length"],formula:"π × (width/2) × (height/2) × length × density"},"CR Square":{params:["Width","Corner Radius","Length"],formula:"(width² - 4×radius² + π×radius²) × length × density"},"CR Rectangle":{params:["Width","Height","Corner Radius","Length"],formula:"(width×height - 4×radius² + π×radius²) × length × density"},Angle:{params:["Width","Height","Thickness 1","Thickness 2","Length"],formula:"(width×T1 + height×T2 - T1×T2) × length × density"},Channel:{params:["Width","Height","Thickness 1","Thickness 2","Length"],formula:"(width×T1 + 2×height×T2 - 2×T1×T2) × length × density"},"T Bar":{params:["Width","Height","Thickness 1","Thickness 2","Length"],formula:"(width×T1 + (height-T1)×T2) × length × density"},"I Beam":{params:["Width","Height","Flange Thickness","Web Thickness","Length"],formula:"(2×width×flange_T + (height-2×flange_T)×web_T) × length × density"},"C Shape":{params:["Width","Height","Thickness","Gap","Length"],formula:"width×T + 2×(height-gap)×T × length × density"},"E Shape":{params:["Width","Height","Thickness 1","Thickness 2","Length"],formula:"(3×width×T1 + 2×(height-T1)×T2) × length × density"}};function init(){console.log("Initializing enhanced application..."),loadMaterials(),loadShapes();try{"undefined"!=typeof THREE?initThreeJS():console.warn("Three.js not loaded, continuing without 3D visualization")}catch(e){console.error("Error initializing Three.js:",e)}document.getElementById("shape").addEventListener("change",updateDimensions),document.getElementById("material").addEventListener("change",updateVisualization),document.getElementById("shape").addEventListener("change",updateVisualization)}function loadMaterials(){const e=document.getElementById("material");e&&Object.keys(materialsData).forEach(t=>{const n=document.createElement("option");n.value=t,n.textContent=t,e.appendChild(n)})}function loadShapes(){const e=document.getElementById("shape");e&&Object.keys(shapesData).forEach(t=>{const n=document.createElement("option");n.value=t,n.textContent=t,e.appendChild(n)})}function updateDimensions(){const e=document.getElementById("shape").value,t=document.getElementById("dimensions");if(document.getElementById("results").classList.add("hidden"),!e)return void(t.innerHTML="");const n=shapesData[e].params;let a="";n.forEach((e,t)=>{a+=`\n            <div class="dimension-row">\n                <label class="dimension-label">${e}</label>\n                <div class="dimension-input">\n                    <div class="form-group">\n                        <input type="number" id="param${t+1}" step="0.001" min="0.001" placeholder="Enter ${e.toLowerCase()}">\n                    </div>\n                    <div class="form-group">\n                        <select id="unit${t+1}">\n                            <option value="in">in</option>\n                            <option value="ft">ft</option>\n                            <option value="yd">yd</option>\n                            <option value="mm">mm</option>\n                            <option value="cm">cm</option>\n                            <option value="m">m</option>\n                        </select>\n                    </div>\n                </div>\n            </div>\n        `}),t.innerHTML=a,n.forEach((e,t)=>{const n=document.getElementById(`param${t+1}`),a=document.getElementById(`unit${t+1}`);n&&n.addEventListener("input",updateVisualization),a&&a.addEventListener("change",updateVisualization)}),updateVisualization()}function updateVisualization(){const e=document.getElementById("material").value,t=document.getElementById("shape").value;if(!t)return;const n=e?materialsData[e].color:"#8C9196",a=document.getElementById("shapeInfo"),i=document.getElementById("materialInfo");if(e){const t=materialsData[e];i.innerHTML=`\n            <strong>${e}</strong><br>\n            Density: ${t.density} g/cm³\n        `}else i.innerHTML="";const o={},s=shapesData[t];s&&s.params&&s.params.forEach((e,t)=>{const n=document.getElementById(`param${t+1}`),a=document.getElementById(`unit${t+1}`);if(n&&n.value&&a){const t=parseFloat(n.value),i=a.value;if(t>0){const n=convertToInches(t,i),a=e.toLowerCase();a.includes("diameter")?a.includes("outer")?o.outerDiameter=n:a.includes("inner")?o.innerDiameter=n:o.diameter=n:a.includes("width")?a.includes("1")?o.width1=n:a.includes("2")?o.width2=n:o.width=n:a.includes("height")?o.height=n:a.includes("length")?o.length=n:a.includes("thickness")?a.includes("1")?o.thickness1=n:a.includes("2")?o.thickness2=n:a.includes("wall")?o.wall=n:o.thickness=n:a.includes("wall")?o.wall=n:a.includes("radius")?o.radius=n:a.includes("gap")&&(o.gap=n)}}}),"function"==typeof create3DShape&&create3DShape(t,n,o),a.textContent=`${t} - ${shapesData[t].formula}`}function convertToCentimeters(e,t){switch(t){case"mm":return e/10;case"cm":default:return e;case"m":return 100*e;case"in":return 2.54*e;case"ft":return 30.48*e;case"yd":return 91.44*e}}function convertToInches(e,t){switch(t){case"cm":return e/2.54;case"m":return 100*e/2.54;case"mm":return e/10/2.54;case"ft":return 12*e;case"yd":return 36*e;default:return e}}function calculateWeight(){const e=document.getElementById("material").value,t=document.getElementById("shape").value,n=parseFloat(document.getElementById("quantity").value)||1;if(!e||!t)return void alert("Please select both material and shape");const a=shapesData[t],i=materialsData[e],o=[];for(let e=1;e<=a.params.length;e++){const t=parseFloat(document.getElementById(`param${e}`).value),n=document.getElementById(`unit${e}`).value;if(!t||t<=0)return void alert(`Please enter a valid value for ${a.params[e-1]}`);o.push(convertToCentimeters(t,n))}let s=0;try{switch(t){case"Round":const e=o[0]/2;s=Math.PI*e*e*o[1];break;case"Sphere":const t=o[0]/2;s=4/3*Math.PI*Math.pow(t,3);break;case"Square":s=o[0]*o[0]*o[1];break;case"Rectangle":case"Plate":case"Sheet":case"Rectangle/Plate":case"Rectangle/Plate/Sheet":s=o[0]*o[1]*o[2];break;case"Hexagonal":const n=o[0]/2;s=3*Math.sqrt(3)/2*n*n*o[1];break;case"Octagonal":const a=o[0]/2;s=2*(1+Math.sqrt(2))*a*a*o[1];break;case"Pipe":const i=o[0]/2,l=(o[0]-2*o[1])/2;if(l<0)return void alert("Wall thickness cannot exceed outer diameter!");s=Math.PI*(i*i-l*l)*o[2];break;case"Square Pipe":const r=o[0]*o[0],d=o[0]-2*o[1];if(d<=0)return void alert("Wall thickness too large for outer dimension!");s=(r-d*d)*o[2];break;case"Rectangle Pipe":const c=o[0]*o[1],u=o[0]-2*o[2],m=o[1]-2*o[2];if(u<=0||m<=0)return void alert("Wall thickness too large for outer dimensions!");s=(c-u*m)*o[3];break;case"Triangle":s=.5*o[0]*o[1]*o[2];break;case"Trapezoid":case"Trapezium":case"Trapezoid/Trapezium":s=.5*(o[0]+o[1])*o[2]*o[3];break;case"Oval":s=Math.PI*(o[0]/2)*(o[1]/2)*o[2];break;case"Ring":const h=o[0]/2,g=o[1]/2;if(g>=h)return void alert("Inner diameter must be less than outer diameter!");s=Math.PI*(h*h-g*g)*o[2];break;case"Hexagonal (Round)":const y=o[0]/2,p=(o[0]-2*o[1])/2;if(p<0)return void alert("Wall thickness cannot exceed outer diameter!");const D=3*Math.sqrt(3)/2*y*y;s=(D-Math.PI*p*p)*o[2];break;case"Square (Round)":const f=o[0]*o[0],k=o[1]/2;s=(f-Math.PI*k*k)*o[2];break;case"CR Square":s=(o[0]*o[0]-4*o[1]*o[1]+Math.PI*o[1]*o[1])*o[2];break;case"CR Rectangle":s=(o[0]*o[1]-4*o[2]*o[2]+Math.PI*o[2]*o[2])*o[3];break;case"Angle":s=(o[0]*o[2]+o[1]*o[3]-o[2]*o[3])*o[4];break;case"Channel":s=(o[0]*o[2]+2*o[1]*o[3]-2*o[2]*o[3])*o[4];break;case"C Shape":s=(o[0]*o[2]+2*(o[1]-o[3])*o[2])*o[4];break;case"T Bar":s=(o[0]*o[2]+(o[1]-o[2])*o[3])*o[4];break;case"I Beam":const E=2*o[0]*o[2],T=(o[1]-2*o[2])*o[3];s=(E+T)*o[4];break;case"E Shape":s=(3*o[0]*o[2]+2*(o[1]-o[2])*o[3])*o[4];break;default:s=o[0]*o[1]*(o[2]||1)}const e=s*i.density*n,a=e/1e3,l=2.20462*a,r=16*l;document.getElementById("weightKgs").textContent=a.toFixed(3),document.getElementById("weightGrams").textContent=e.toFixed(2),document.getElementById("weightLbs").textContent=l.toFixed(3),document.getElementById("weightOunces").textContent=r.toFixed(2);const d=parseFloat(document.getElementById("rate").value),c=document.getElementById("rateUnit").value,u=document.getElementById("totalCost");if(d&&d>0){let t=0,n="";switch(c){case"per kg":t=d*a,n=d.toFixed(1)+"/kg";break;case"per lb":t=d*l,n=d.toFixed(1)+"/lb";break;case"per gram":t=d*e,n=d.toFixed(3)+"/g";break;case"per ounce":t=d*r,n=d.toFixed(3)+"/oz"}document.getElementById("costValue").textContent=`(${n}) : ${t.toFixed(2)}`,u.classList.remove("hidden")}else u.classList.add("hidden");document.getElementById("results").classList.remove("hidden")}catch(e){alert("Error in calculation: "+e.message)}}function clearForm(){document.getElementById("material").value="",document.getElementById("shape").value="",document.getElementById("quantity").value="1",document.getElementById("rate").value="",document.getElementById("rateUnit").value="per kg",document.getElementById("dimensions").innerHTML="",document.getElementById("results").classList.add("hidden"),"function"==typeof clearThreeJSVisualization&&clearThreeJSVisualization(),document.getElementById("shapeInfo").textContent="Choose a material and shape to see the 3D visualization",document.getElementById("materialInfo").innerHTML=""}window.addEventListener("DOMContentLoaded",init);